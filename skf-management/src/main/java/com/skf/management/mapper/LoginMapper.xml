<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.skf.management.mapper.LoginMapper">
   <resultMap id="BaseResultMap" type="com.skf.management.model.User">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jun 11 15:04:41 CST 2018.
    -->
    <id column="USR_CODE" jdbcType="VARCHAR" property="code" />
    <result column="USR_NAME" jdbcType="VARCHAR" property="name" />
    <result column="USR_COMPANY" jdbcType="VARCHAR" property="company" />
    <result column="USR_ADDRESS" jdbcType="VARCHAR" property="address" />
    <result column="USR_RL_ID" jdbcType="INTEGER" property="roleId" />
    <result column="USR_PASSWORD" jdbcType="VARCHAR" property="password" />
    <result column="USR_PHONE" jdbcType="VARCHAR" property="phone" />
    <result column="USR_EMAIL" jdbcType="VARCHAR" property="email" />
    <result column="USR_LOGIN_TIME" jdbcType="TIMESTAMP" property="loginTime" />
  </resultMap>
  <resultMap extends="BaseResultMap" id="ResultMapWithBLOBs" type="com.skf.management.model.User">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jun 11 15:04:41 CST 2018.
    -->
    <result column="USR_IMG" jdbcType="LONGVARBINARY" property="img" />
  </resultMap>
  <sql id="Base_Column_List">
    USR_CODE, USR_NAME, USR_COMPANY, USR_ADDRESS, USR_RL_ID, USR_PASSWORD, USR_PHONE, 
    USR_EMAIL, USR_LOGIN_TIME
  </sql>
  <sql id="Blob_Column_List">
    USR_IMG
  </sql>
   <select id="getUserCode" parameterType="map" resultMap="ResultMapWithBLOBs">
	    select 
		
		<include refid="Base_Column_List" />
    	,
    	<include refid="Blob_Column_List" />	

	    from SKF_USR 
	    where (USR_PHONE= #{username,jdbcType=VARCHAR} OR USR_EMAIL= #{useremail,jdbcType=VARCHAR} )
	     and USR_PASSWORD= #{password,jdbcType=VARCHAR}
    </select>
    
   
    <select id="checkToken" parameterType="map" resultType="java.lang.Long">
   		 select count(*)  from SKF_USR 
   		 where (USR_PHONE= #{username,jdbcType=VARCHAR} OR USR_EMAIL= #{useremail,jdbcType=VARCHAR} )
   		  and USR_CODE= #{usercode,jdbcType=VARCHAR}
    </select>
  	
  	<select id="getUsrCstmList" parameterType="java.lang.String" resultType="java.lang.String">
	    select CSTM_CODE  from SKF_USR_CSTM
	    where USR_CODE= #{usercode,jdbcType=VARCHAR}
    </select>
    
    <select id="getUsrOemList" parameterType="java.lang.String" resultType="java.lang.String">
	    select OEM_CODE  from SKF_USR_OEM 
	    where USR_CODE= #{usercode,jdbcType=VARCHAR}
    </select>
     <select id="getUsrRoleId" parameterType="java.lang.String" resultType="java.lang.Integer">
	    select 
		
		USR_RL_ID

	    from SKF_USR 
	    where USR_CODE=#{usercode,jdbcType=VARCHAR}
    </select>
    
</mapper>